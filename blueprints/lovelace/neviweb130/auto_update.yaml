blueprint:
  name: Neviweb130 â€“ Carte de mise Ã  jour
  description: Affiche lâ€™Ã©tat, la progression et les dÃ©tails de mise Ã  jour de Neviweb130.
  author: Claude G.
  domain: lovelace
  input:
    update_entity:
      name: EntitÃ© Update
      description: Lâ€™entitÃ© update.neviweb130_update
      selector:
        entity:
          domain: update

type: vertical-stack
cards:
  - type: entities
    title: Mise Ã  jour Neviweb130
    entities:
      - entity: !input update_entity
        name: Version disponible
      - type: attribute
        entity: !input update_entity
        attribute: installed_version
        name: Version installÃ©e
      - type: attribute
        entity: !input update_entity
        attribute: latest_version
        name: Version disponible
      - type: section
        label: DÃ©tails
      - type: attribute
        entity: !input update_entity
        attribute: update_status
        name: Statut
      - type: attribute
        entity: !input update_entity
        attribute: update_percentage
        name: Progression
      - type: attribute
        entity: !input update_entity
        attribute: rollback_status
        name: Rollback
      - type: attribute
        entity: !input update_entity
        attribute: last_check
        name: DerniÃ¨re vÃ©rification
      - type: attribute
        entity: !input update_entity
        attribute: next_check
        name: Prochaine vÃ©rification
      - type: attribute
        entity: !input update_entity
        attribute: check_interval
        name: Intervalle de vÃ©rification

  - type: markdown
    content: >
      {% set status = state_attr(!input update_entity, 'update_status') %}
      {% set pct = state_attr(!input update_entity, 'update_percentage') %}

      ### ğŸ”§ Ã‰tat de la mise Ã  jour

      **Statut :**  
      {% if status == "preparing" %} ğŸ› ï¸ PrÃ©paration  
      {% elif status == "backup" %} ğŸ—„ï¸ Sauvegarde  
      {% elif status == "updating" %} ğŸ”„ Mise Ã  jour  
      {% elif status == "rollback" %} ğŸ” Rollback  
      {% elif status == "success" %} âœ… RÃ©ussie  
      {% elif status == "failed" %} âŒ Ã‰chec  
      {% else %} ğŸ’¤ En attente  
      {% endif %}

      **Progression :**  
      {% if pct != None %} âŒ› {{ pct }}%  
      {% else %} â³ En attente  
      {% endif %}
